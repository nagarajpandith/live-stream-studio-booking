{% extends 'base.html' %} 
{% block style %} 
.card-margin { margin-bottom:
1.875rem; } 
.card { border: 0; box-shadow: 0px 0px 10px 0px rgba(82, 63, 105,
0.1); -webkit-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
-moz-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1); -ms-box-shadow: 0px
0px 10px 0px rgba(82, 63, 105, 0.1); } .card { position: relative; display:
flex; flex-direction: column; min-width: 0; word-wrap: break-word;
background-color: #ffffff; background-clip: border-box; border: 1px solid
#e6e4e9; border-radius: 8px; } .card .card-header.no-border { border: 0; } .card
.card-header { background: none; padding: 0 0.9375rem; font-weight: 500;
display: flex; align-items: center; min-height: 50px; } 
.card-header:first-child
{ border-radius: calc(8px - 1px) calc(8px - 1px) 0 0; } .widget-49
.widget-49-title-wrapper { display: flex; align-items: center; } .widget-49
.widget-49-title-wrapper .widget-49-date-primary { display: flex; align-items:
center; justify-content: center; flex-direction: column; background-color:
#edf1fc; width: 4rem; height: 4rem; border-radius: 50%; } .widget-49
.widget-49-title-wrapper .widget-49-date-primary .widget-49-date-day { color:
#4e73e5; font-weight: 500; font-size: 1.5rem; line-height: 1; } .widget-49
.widget-49-title-wrapper .widget-49-date-primary .widget-49-date-month { color:
#4e73e5; line-height: 1; font-size: 1rem; text-transform: uppercase; }
.widget-49 .widget-49-title-wrapper .widget-49-date-secondary { display: flex;
align-items: center; justify-content: center; flex-direction: column;
background-color: #fcfcfd; width: 4rem; height: 4rem; border-radius: 50%; }
.widget-49 .widget-49-title-wrapper .widget-49-date-secondary
.widget-49-date-day { color: #dde1e9; font-weight: 500; font-size: 1.5rem;
line-height: 1; } .widget-49 .widget-49-title-wrapper .widget-49-date-secondary
.widget-49-date-month { color: #dde1e9; line-height: 1; font-size: 1rem;
text-transform: uppercase; } .widget-49 .widget-49-title-wrapper
.widget-49-date-success { display: flex; align-items: center; justify-content:
center; flex-direction: column; background-color: #e8faf8; width: 4rem; height:
4rem; border-radius: 50%; } .widget-49 .widget-49-title-wrapper
.widget-49-date-success .widget-49-date-day { color: #17d1bd; font-weight: 500;
font-size: 1.5rem; line-height: 1; } .widget-49 .widget-49-title-wrapper
.widget-49-date-success .widget-49-date-month { color: #17d1bd; line-height: 1;
font-size: 1rem; text-transform: uppercase; } .widget-49
.widget-49-title-wrapper .widget-49-date-info { display: flex; align-items:
center; justify-content: center; flex-direction: column; background-color:
#ebf7ff; width: 4rem; height: 4rem; border-radius: 50%; } .widget-49
.widget-49-title-wrapper .widget-49-date-info .widget-49-date-day { color:
#36afff; font-weight: 500; font-size: 1.5rem; line-height: 1; } .widget-49
.widget-49-title-wrapper .widget-49-date-info .widget-49-date-month { color:
#36afff; line-height: 1; font-size: 1rem; text-transform: uppercase; }
.widget-49 .widget-49-title-wrapper .widget-49-date-warning { display: flex;
align-items: center; justify-content: center; flex-direction: column;
background-color: floralwhite; width: 4rem; height: 4rem; border-radius: 50%; }
.widget-49 .widget-49-title-wrapper .widget-49-date-warning .widget-49-date-day
{ color: #FFC868; font-weight: 500; font-size: 1.5rem; line-height: 1; }
.widget-49 .widget-49-title-wrapper .widget-49-date-warning
.widget-49-date-month { color: #FFC868; line-height: 1; font-size: 1rem;
text-transform: uppercase; } .widget-49 .widget-49-title-wrapper
.widget-49-date-danger { display: flex; align-items: center; justify-content:
center; flex-direction: column; background-color: #feeeef; width: 4rem; height:
4rem; border-radius: 50%; } .widget-49 .widget-49-title-wrapper
.widget-49-date-danger .widget-49-date-day { color: #F95062; font-weight: 500;
font-size: 1.5rem; line-height: 1; } .widget-49 .widget-49-title-wrapper
.widget-49-date-danger .widget-49-date-month { color: #F95062; line-height: 1;
font-size: 1rem; text-transform: uppercase; } .widget-49
.widget-49-title-wrapper .widget-49-date-light { display: flex; align-items:
center; justify-content: center; flex-direction: column; background-color:
#fefeff; width: 4rem; height: 4rem; border-radius: 50%; } .widget-49
.widget-49-title-wrapper .widget-49-date-light .widget-49-date-day { color:
#f7f9fa; font-weight: 500; font-size: 1.5rem; line-height: 1; } .widget-49
.widget-49-title-wrapper .widget-49-date-light .widget-49-date-month { color:
#f7f9fa; line-height: 1; font-size: 1rem; text-transform: uppercase; }
.widget-49 .widget-49-title-wrapper .widget-49-date-dark { display: flex;
align-items: center; justify-content: center; flex-direction: column;
background-color: #ebedee; width: 4rem; height: 4rem; border-radius: 50%; }
.widget-49 .widget-49-title-wrapper .widget-49-date-dark .widget-49-date-day {
color: #394856; font-weight: 500; font-size: 1.5rem; line-height: 1; }
.widget-49 .widget-49-title-wrapper .widget-49-date-dark .widget-49-date-month {
color: #394856; line-height: 1; font-size: 1rem; text-transform: uppercase; }
.widget-49 .widget-49-title-wrapper .widget-49-date-base { display: flex;
align-items: center; justify-content: center; flex-direction: column;
background-color: #f0fafb; width: 4rem; height: 4rem; border-radius: 50%; }
.widget-49 .widget-49-title-wrapper .widget-49-date-base .widget-49-date-day {
color: #68CBD7; font-weight: 500; font-size: 1.5rem; line-height: 1; }
.widget-49 .widget-49-title-wrapper .widget-49-date-base .widget-49-date-month {
color: #68CBD7; line-height: 1; font-size: 1rem; text-transform: uppercase; }
.widget-49 .widget-49-title-wrapper .widget-49-meeting-info { display: flex;
flex-direction: column; margin-left: 1rem; } .widget-49 .widget-49-title-wrapper
.widget-49-meeting-info .widget-49-pro-title { color: #3c4142; font-size: 14px;
} .widget-49 .widget-49-title-wrapper .widget-49-meeting-info
.widget-49-meeting-time { color: #B1BAC5; font-size: 13px; } .widget-49
.widget-49-meeting-points { font-weight: 400; font-size: 13px; margin-top:
.5rem; } .widget-49 .widget-49-meeting-points .widget-49-meeting-item { display:
list-item; color: #727686; } .widget-49 .widget-49-meeting-points
.widget-49-meeting-item span { margin-left: .5rem; } .widget-49
.widget-49-meeting-action { text-align: right; } .widget-49
.widget-49-meeting-action a { text-transform: uppercase; } .wrapper { display:
flex; justify-content: center; align-items: center } .page-link { position:
relative; display: block; color: #D85600 !important; text-decoration: none;
background-color: #fff; border: 1px solid #D85600 !important } .page-link:hover
{ z-index: 2; color: #fff !important; background-color: #D85600; border-color:
#024dbc } .page-link:focus { z-index: 3; outline: 0; box-shadow: none }

{%endblock style %} 
{% block footer_parent %}
{% endblock %}
{% block content %} 
<div class="container mt-5" style="padding-top: 100px;">
  {% if messages %}
    <div class="card notification-card notification-invitation">
      <div class="card-body">
        {% for message in messages %}
          <div class="card-title">{{message}}</div>
        {% endfor %}
      </div>
    </div>
  {% endif %}
  {% if request.user.is_authenticated %}
  <div class="col-11 text-center mt-4 mb-4">
    <h3>Manage bookings</h3>
  </div>
  <div class="row">
    {% for app in bookings %}
    <div class="col-lg-4">
      <div class="card card-margin">
        <div class="card-header no-border">
          <h5 class="card-title">{{app.first_name}} {{app.last_name}}</h5>
        </div>
        <div class="card-body pt-0">
          <div class="widget-49">
            <div class="widget-49-title-wrapper">
              <div class="widget-49-date-primary">
                <span class="widget-49-date-day"
                  >{{app.sent_date|date:"d"}}</span
                >
                <span class="widget-49-date-month"
                  >{{app.sent_date|date:"M"}}</span
                >
              </div>
              <div class="widget-49-meeting-info">
                <span class="widget-49-pro-title">{{app.email}}</span>
                <span class="widget-49-meeting-time">Starts at {{app.event_date}}</span>
                <span class="widget-49-meeting-time">Ends at {{app.end_date}}</span>
              </div>
            </div>
            <div class="widget-49-meeting-points">
              <span>{{app.request}}</span>
            </div>
            <hr class="w-100" />
            {% if app.accepted == False %}
            <form method="POST" action="{% url 'manage' %}">
              {% csrf_token %}
              <div class="form-group">
                <input hidden="true" name="booking-id" value="{{app.id}}" />
                <input
                  class="btn-block btn-primary form-control"
                  type="submit"
                  value="Accept"
                  name="_accept"
                />
              </div>
              <div class="form-group">
                <input class="btn-block btn-danger form-control" name="_reject" type="button" value="Reject" onclick= "ShowForm({{app.id}})" id="reject"/>
              </div>
            </form>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {%empty%}
    <h3>No booking requests.....</h3>
    {% endfor %}
  </div>

  {% if is_paginated %}
  <div class="wrapper">
    <nav aria-label="Page navigation example">
      <ul class="pagination">
        {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{page_obj.previous_page_number}}"
            >Previous</a
          >
        </li>
        {% endif %} {% for number in page_obj.paginator.page_range %}
        <li class="page-item">
          <a class="page-link" href="?page={{number}}">{{number}}</a>
        </li>
        {% endfor %} {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{page_obj.next_page_number}}"
            >Next</a
          >
        </li>
        {% endif %}
      </ul>
    </nav>
  </div>
  {% endif %}
   <!-- Modal Reject -->
   <div class="overlay"></div>
   <div class="reason-modal" id="dvReason">
     <div class="rej-nav">
       <h4>Reject Booking</h4>
       <i onclick="closeForm()" class="fas fa-times"></i>
     </div>
     <!-- <p class="rej-for"></p> -->
     <form class="reason-form" method="POST" action="{% url 'manage' %}">
       {% csrf_token %}
       <input hidden="true" class="booking-rej" name="booking-id" value="" />
       <div class="form-group">
         <label for="txtReason">Reason:</label>
         <textarea required type="text" name="textReason" id="txtReason" placeholder="Please state your reason here"></textarea>
       </div>
       <div class="form-group">
         <input class="btn-block btn-danger form-control" name="_reject" type="submit" value="Send Message" id="reject"/>
       </div>
     </form>
   </div>
</div>
{% else %}
	{% include "404.html" %}
{% endif %}
{% endblock content %}

{% block script %}
function ShowForm(id) {
  console.log(id);
  let x = document.getElementById('reject')
  document.querySelector(".booking-rej").value = id;
  if (x.value == "Reject") {
    document.getElementById('dvReason').style.display = 'block';
  document.querySelector(".overlay").style.display="block";

  } else {
    document.getElementById('dvReason').style.display = 'none';
    document.querySelector(".overlay").style.display="none";
  }
}
function closeForm(){
  document.getElementById('dvReason').style.display = 'none';
  document.querySelector(".overlay").style.display="none";
}
{% endblock script %}